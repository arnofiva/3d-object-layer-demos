import{nc as z,hy as p,nd as y,ne as j,nf as f,ng as S,bh as u,nh as b,bs as D,br as N,ni as L,nj as H,eN as Z,kl as M,nk as E,nl as $,nm as R,lo as Y,iE as v,nn as h,k9 as P,no as x,j_ as G,dt as A}from"./main-79e5ed80.js";import{f as U,s as O}from"./elevationInfoUtils-287337e4.js";import{U as W}from"./dragEventPipeline-491faa8f.js";function X(n,t){return C(n,()=>t)}function un(n){return C(n,t=>t.plane)}function C(n,t){const e=u(),r=u();let o=!1;return l=>{const c=t(l);if(l.action==="start"){const i=p(l.screenStart,y(j.get())),s=f(n.state.camera,i,w);s!=null&&(o=S(c,s,e))}if(!o)return null;const a=p(l.screenEnd,y(j.get())),d=f(n.state.camera,a,w);return d==null?null:S(c,d,r)?{...l,renderStart:e,renderEnd:r,plane:c,ray:d}:null}}function k(n,t,e=0,r=null,o=null){let l=null;return c=>{if(c.action==="start"&&(l=n.sceneIntersectionHelper.intersectElevationFromScreen(N(c.screenStart.x,c.screenStart.y),t,e,o),l!=null&&r!=null&&!L(l,l,r))||l==null)return null;const a=n.sceneIntersectionHelper.intersectElevationFromScreen(N(c.screenEnd.x,c.screenEnd.y),t,e,o);return a!=null&&(r==null||L(a,a,r))?{...c,mapStart:l,mapEnd:a}:null}}function J(n,t,e,r=null,o=null){return k(n,e,U(t,n,e),r,o)}function Q(n,t,e,r=null,o=null){return J(n,e,O(t),r,o)}function dn(n,t,e,r){const o=t.toMap(n.screenStart,{include:[e]});return o!=null?Q(t,e,o,r):null}function B(n,t){const e=q,r=_,o=H();n.renderCoordsHelper.worldUpAtPosition(t,e);const l=Z(o,e,M(r,t,n.state.camera.eye));return Z(l,l,e),E(t,l,o)}function mn(n,t,e){let r=null;const o=new W;return o.next(X(n,B(n,t))).next(F(n,t)).next(V(n,e)).next(l=>{l.mapEnd.x=l.mapStart.x,l.mapEnd.y=l.mapStart.y,r=l}),l=>(r=null,o.execute(l),r)}function F(n,t){const e=u(),r=b(t);n.renderCoordsHelper.worldUpAtPosition(t,e);const o=u(),l=u(),c=a=>(M(a,a,t),$(e,a,a),n.viewingMode==="global"&&b(a)*Math.sign(R(e,a))<.001-r&&M(a,Y(a,e,.001),t),v(a,a,t),a);return a=>(a.renderStart=c(D(o,a.renderStart)),a.renderEnd=c(D(l,a.renderEnd)),a)}function V(n,t){const e=n.renderCoordsHelper;return r=>{const o=e.fromRenderCoords(r.renderStart,t),l=e.fromRenderCoords(r.renderEnd,t);return o!=null&&l!=null?{...r,mapStart:o,mapEnd:l}:null}}var I;function In(n){let t=null;return e=>{switch(e.action){case"start":t=n.disableDisplay();break;case"end":case"cancel":t!=null&&(t.remove(),t=null)}return e}}function gn(n,t=null){const e=h(n.state.viewingMode);e.options.selectionMode=!0,e.options.store=P.MIN,e.options.hud=!1;const r=N(),o={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},l=u(),c=t??n.spatialReference,a=i=>{n.map.ground&&n.map.ground.opacity<1?o.exclude.add(x):o.exclude.delete(x),n.sceneIntersectionHelper.intersectIntersectorScreen(p(i,r),e,o);const s=e.results.min;let m;if(s.getIntersectionPoint(l))m=s.intersector===G.TERRAIN?I.GROUND:I.OTHER;else{if(!e.results.ground.getIntersectionPoint(l))return null;m=I.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(l,c),surfaceType:m}};let d;return i=>{if(i.action==="start"){const m=a(i.screenStart);d=m!=null?m.location:null}if(d==null)return null;const s=a(i.screenEnd);return s!=null&&s.location!=null?{...i,mapStart:d,mapEnd:s.location,surfaceType:s.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(I||(I={}));const q=u(),_=u(),w=z(),K="theme-style";function T(n,t){return rn(en(nn(tn(n),t)),t.size)}function nn(n,{accentColor:t,contrastColor:e}){const r=t.toHex(),o=t.a,l=e.toHex(),c=e.a,a=n.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem(K);return a&&(a.innerHTML=`
      .contrast-fill { fill: ${l}; fill-opacity: ${c}; }
      .contrast-stroke { stroke: ${l}; stroke-opacity: ${c};  }
      .accent-fill { fill: ${r}; fill-opacity: ${o}; }
      .accent-stroke { stroke: ${r}; stroke-opacity:  ${o}; }`),n}function tn(n){const t=n.split(",")[1],e=atob(t);return new DOMParser().parseFromString(e,"image/svg+xml")}function en(n){const t=new XMLSerializer().serializeToString(n);return`data:image/svg+xml;base64,${btoa(t)}`}function rn(n,t){const e=new Image(t,t);return e.src=n,e}const ln="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NnoiIGNsYXNzPSJhY2NlbnQtZmlsbCIvPjxwYXRoIHN0cm9rZS13aWR0aD0iNC45OSIgZD0iTTIwLjA1IDQwLjg2YTE1LjA1IDE1LjA1IDAgMCAwIDE3LjE0LTEuNSAxNS4wNSAxNS4wNSAwIDAgMCA0LjQ3LTE2LjY1IDE1LjA1IDE1LjA1IDAgMCAwLTIyLjcyLTcuMTUgMTUuMDUgMTUuMDUgMCAwIDAtNS41IDcuMTUiIGNsYXNzPSJjb250cmFzdC1zdHJva2UiLz48cGF0aCBkPSJtMTAuOTcgMzUuNTcgNS4zOCAxMi4wNyA3Ljc5LTEzLjQ3LTEzLjE3IDEuNHoiIGNsYXNzPSJjb250cmFzdC1maWxsIi8+PC9zdmc+",on="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxjaXJjbGUgY3g9IjM5LjQ3OCIgY3k9IjMuMDc4IiByPSIyOCIgY2xhc3M9ImFjY2VudC1maWxsIiB0cmFuc2Zvcm09InJvdGF0ZSg0MC41NDIpIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI1IiBkPSJtNy4wNzQgMzAuMDUzIDI5LjM5NyAxMS45ODUtMy42NzMtMzMuNDkzIiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSIyLjk5NiIgZD0iTTI0LjUwNCAyMy4yMDdhMTEuOTgyIDExLjk4MiAwIDAgMC05LjggNy41MDciIGNsYXNzPSJjb250cmFzdC1zdHJva2UgY29udHJhc3QtZmlsbCIvPjxwYXRoIGQ9Im0yOS44MTggMjIuODA4LTYuMTg0IDQuNi0uNTQxLTguMzY0eiIgY2xhc3M9ImNvbnRyYXN0LWZpbGwiLz48L3N2Zz4=",g=64;function pn(n,t){const{accentColor:e,contrastColor:r,preMultiplyAlpha:o}=t;return n.fromData(`heading-rotate:[accent:${e},contrast:${r},size:${g}]`,()=>new A(T(ln,{accentColor:e,contrastColor:r,size:g}),{mipmap:!0,preMultiplyAlpha:o}))}function Nn(n,t){const{accentColor:e,contrastColor:r,preMultiplyAlpha:o}=t;return n.fromData(`tilt-rotate:[accent:${e},contrast:${r},size:${g}]`,()=>new A(T(on,{accentColor:e,contrastColor:r,size:g}),{mipmap:!0,preMultiplyAlpha:o}))}export{In as A,Q as D,gn as F,X as H,dn as M,mn as P,J as T,un as U,V as k,Nn as l,pn as n};
