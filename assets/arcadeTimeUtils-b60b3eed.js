import{bH as f,bI as l}from"./index-cdda5707.js";function m(n){return n?.timeZoneIANA?n?.timeZoneIANA:n?.timeZone?l(n,""):""}class a{constructor(){this.dateTimeReferenceMetaData=null,this._fieldTimeZoneIndex={},this._fieldIndex=null,this._ianaPreferred=null,this._ianaTimeInfo=null,this._ianaEditFields=null,this._ianaLayerDateFields=null}static create(e,t){const i=new a;return i.dateTimeReferenceMetaData=t,i._fieldIndex=e instanceof f?e:new f(e),i}static createFromLayer(e){if(!e)return null;if(!e.fieldsIndex)return!e.declaredClass&&e.fields?a.create(e.fields,e):null;const t=new a;return t._fieldIndex=e.fieldsIndex,t.dateTimeReferenceMetaData={timeInfo:e?.timeInfo?.toJSON()??null,editFieldsInfo:e?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:e?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:e?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:e?.datesInUnknownTimezone===!0},t}fieldTimeZone(e){const t=this._fieldIndex?.get(e);if(!t||t.type!=="date"&&t.type!=="esriFieldTypeDate")return null;const i=this._fieldTimeZoneIndex[t.name];if(i!==void 0)return i;const o=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:this.dateTimeReferenceMetaData?.datesInUnknownTimezone===!0},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:this.dateTimeReferenceMetaData?.datesInUnknownTimezone===!0},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:this.dateTimeReferenceMetaData?.datesInUnknownTimezone===!0},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:this.dateTimeReferenceMetaData?.datesInUnknownTimezone===!0}];for(const r of o)if(r.field===t.name){const s=this.convertToIANA(r.timeReference,r.isunknown);return this._fieldTimeZoneIndex[t.name]=s,s}const d=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);return this._fieldTimeZoneIndex[t.name]=d,d}convertToIANA(e,t){return t?"unknown":m(e)}get layerPreferredTimeZone(){if(this._ianaPreferred!==null)return this._ianaPreferred;this._ianaPreferred="";const e=this.dateTimeReferenceMetaData?.preferredTimeReference;return this._ianaPreferred=this.convertToIANA(e,this.dateTimeReferenceMetaData?.datesInUnknownTimezone===!0),this._ianaPreferred}get layerTimeInfoTimeZone(){if(this._ianaTimeInfo!==null)return this._ianaTimeInfo;this._ianaTimeInfo="";const e=this.dateTimeReferenceMetaData?.timeInfo?.timeReference;return this._ianaTimeInfo=this.convertToIANA(e,!1),this._ianaTimeInfo}get layerEditFieldsTimeZone(){if(this._ianaEditFields!==null)return this._ianaEditFields;this._ianaEditFields="";const e=this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference;return this._ianaEditFields=this.convertToIANA(e,this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaEditFields}get layerDateFieldsTimeZone(){if(this._ianaLayerDateFields!==null)return this._ianaLayerDateFields;this._ianaLayerDateFields="";const e=this.dateTimeReferenceMetaData?.dateFieldsTimeReference;return this._ianaLayerDateFields=this.convertToIANA(e,this.dateTimeReferenceMetaData?.datesInUnknownTimezone===!0),this._ianaLayerDateFields}}export{a as T};
